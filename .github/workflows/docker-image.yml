name: Docker Image CI

on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]

jobs:

  gcc:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3

    - name: Build the Docker image
      run: docker build . --file docker/DockerfileAlpineGCC --tag genesis_gcc

    - name: Run tests in Docker container
      run: docker run -t --rm genesis_gcc /bin/sh -c ctest

  clang:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3

    - name: Build the Docker image
      run: docker build . --file docker/DockerfileAlpineClang --tag genesis_clang

    - name: Run tests in Docker container
      run: docker run -t --rm genesis_clang /bin/sh -c ctest
